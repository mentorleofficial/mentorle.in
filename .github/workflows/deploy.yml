name: Deploy to Vercel

on:
  push:
    branches:
      - main

# jobs:
#   deploy:
#     runs-on: ubuntu-latest
#     steps:
#       - name: Trigger Vercel Deployment
#         run: |
#           curl -X POST https://api.vercel.com/v1/integrations/deploy/prj_SBF7xNWK2UpNSb4pfAm518rXj10n/deployments \
#           -H "Authorization: Bearer ${{ secrets.VERCEL_TOKEN }}" \
#           -H "Content-Type: application/json" \
#           -d '{}'

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          ref: beta
      - run: npm install --global vercel@latest
      - run: vercel pull --yes --environment=preview --token=${{ secrets.VERCEL_TOKEN }} --git-branch=beta
      - run: vercel build --token=${{ secrets.VERCEL_TOKEN }}
      - run: vercel deploy --prebuilt --token=${{ secrets.VERCEL_TOKEN }}
        env:
          VERCEL_ORG_ID: ${{ secrets.VERCEL_ORG_ID }}
          VERCEL_PROJECT_ID: ${{ secrets.VERCEL_PROJECT_ID }}
